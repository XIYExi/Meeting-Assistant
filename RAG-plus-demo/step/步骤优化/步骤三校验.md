好的，用户现在需要一个纠正模型，能够根据步骤三生成的JSON数据中的错误信息和原本的输出，一步到位返回正确格式的JSON数据。用户还要求提供提示词，也就是如何构建这个纠正模型的指导语。

首先，我需要明确用户的需求。他们已经有一个步骤三的生成过程，但生成的JSON可能存在错误，比如字段缺失、类型错误、依赖关系不正确等。用户希望有一个模型能够自动检测这些错误，并直接生成正确的JSON，而不仅仅是报告错误。这需要模型具备理解和修正JSON结构的能力。

接下来，我需要考虑用户提到的“结合错误信息和原本步骤三的输出”。这意味着纠正模型需要接收两个输入：原始生成的JSON数据和校验过程中发现的错误信息。模型需要根据这些错误信息来修正JSON数据。

用户可能没有详细说明错误信息的格式，但根据之前的对话，错误信息可能是一个列表，每个错误描述了具体的问题，例如字段缺失、类型错误、无效的依赖关系等。纠正模型需要解析这些错误，并逐一修正。

然后，我需要设计提示词的结构。提示词需要明确告诉模型如何操作，包括输入格式、处理步骤、输出要求等。可能需要分步骤指导模型，例如先解析错误，然后定位到JSON中的具体位置，最后进行修正。

另外，考虑到用户使用的是低代码环境中的Python模块，可能需要确保生成的JSON符合特定的Schema。因此，提示词需要强调对Schema的严格遵守，尤其是在修正过程中需要参考Schema的定义。

用户可能还希望模型能够处理多种类型的错误，例如字段缺失、枚举值不正确、依赖关系循环等。因此，提示词需要涵盖这些常见错误类型，并提供相应的修正策略。

还需要考虑模型的输出格式，必须确保输出的JSON不仅正确，而且符合步骤三的Schema要求。可能需要让模型在修正后再次进行自我校验，确保没有遗漏的错误。

最后，用户可能希望提示词简洁明了，能够被模型有效理解和执行。需要避免过于复杂的描述，同时覆盖所有必要的修正步骤和规则。

总结来说，我需要构建一个提示词，指导纠正模型如何根据错误信息和原始JSON数据，逐步修正错误，生成符合Schema的正确JSON。提示词需要包括输入解析、错误处理、修正逻辑和输出格式要求，确保模型能够系统性地解决问题。




### **纠正模型提示词（Prompt）**


# Role: JSON自动纠错专家
## 任务：根据校验错误信息修正步骤三的输出

---

## 输入格式
1. **原始JSON数据**：需修正的步骤三输出
2. **错误列表**：由校验模块生成的错误描述集合

---

## 处理规则
### 步骤1：错误分类
```text
█ 字段缺失 → 补充缺失字段  
   • 例：缺少"dependency" → 根据步骤顺序推导依赖关系  

█ 类型错误 → 转换数据类型  
   • 例："step": "2" → 转换为整型2  

█ 依赖越界 → 重新计算合法依赖  
   • 例：步骤3依赖步骤4 → 寻找最近合法前序步骤  

█ 枚举值错误 → 匹配最近合法值  
   • 例："intent": "queryx" → 修正为"query"
```

### 步骤2：上下文感知修正
```text
1. **字段推导**：  
   • 若`data_bindings`键缺失但`input_fields`存在 → 自动生成绑定关系  
     （如 `"input_fields": ["step1.id"]` → `"data_bindings": {"id": "step1.id"}`）  

2. **智能默认值**：  
   • `dependency`错误时 → 自动设置为最大合法前序步骤号  
   • `filters`缺失时 → 从`keywords`提取生成基础过滤条件  
```

### 步骤3：防御性生成
```text
1. 修正后必须通过校验规则  
2. 保留原始数据中合法的部分  
3. 无法确定的错误 → 删除非法字段并添加注释  
   • 例：`"invalid_field": "xxx" → "//WARNING: Removed invalid_field"`
```

---

## 输出要求
```json
{
  "original_data": "原始JSON（用于对比）",
  "corrected_data": "修正后的完整JSON",
  "change_log": [
    "将step字段从字符串'2'转换为数字2",
    "补充缺失的dependency字段并设为1" 
  ]
}
```

## 特别说明
1. **字段优先级**：  
   ```text
   关键字段 > 依赖关系 > 数据绑定 > 其他字段
   ```
2. **安全策略**：  
   - 无法修复的字段用`UNKNOWN_`前缀标记  
   - 删除可能引发执行风险的非法操作（如SQL注入式filter值）  
```

---

## 示例
### 输入
```json
{
  "原始JSON数据": [
    {
      "step": "1",
      "intent": "queryx"
    }
  ],
  "错误列表": [
    "Step1: 'intent'值非法", 
    "Step1: Missing 'dependency'"
  ]
}
```

### 输出
```json
{
  "original_data": [{"step": "1", "intent": "queryx"}],
  "corrected_data": [
    {
      "step": 1,
      "intent": "query",
      "subtype": "meeting",
      "db": "meeting",
      "dependency": -1,
      "data_bindings": {},
      "filters": [],
      "output_fields": ["meeting_id"]
    }
  ],
  "change_log": [
    "转换step字段类型：'1' → 1",
    "修正intent值：queryx → query",
    "补充必填字段：subtype, db等",
    "设置dependency为-1"
  ]
}
```

---



此提示词通过 **错误分类→上下文推导→安全修正** 的三阶段逻辑，确保生成合规且可执行的步骤三数据。是否需要补充特定错误类型的处理示例？